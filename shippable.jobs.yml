jobs:
  - name: deploy-git-branching_runCI
    type: runCI
    flags:
      - deploy-git-branching
    steps:
      - OUT: deploy-git-branching-image-develop
      - OUT: deploy-git-branching-image-release
      - OUT: deploy-git-branching-image-hotfix
      - OUT: deploy-git-branching-image-production

  - name: deploy-git-branching-deploy-develop
    type: deploy
    flags:
      - deploy-git-branching
    steps:
      - IN: deploy-git-branching-image-develop
      - IN: deploy-git-branching-ecs-cluster-develop
      - IN: deploy-git-branching-docker-options
      - IN: deploy-git-branching-params
      - IN: deploy-git-branching-replicas
      - TASK: managed
        deployMethod: replace
  
  - name: deploy-git-branching-deploy-release
    type: deploy
    flags:
      - deploy-git-branching
    steps:
      - IN: deploy-git-branching-deploy-develop
      - IN: deploy-git-branching-image-release
      - IN: deploy-git-branching-ecs-cluster-release
      - IN: deploy-git-branching-docker-options
      - IN: deploy-git-branching-params
      - IN: deploy-git-branching-replicas
      - TASK: managed
        deployMethod: replace
 
  - name: deploy-git-branching-merge-develop
    type: runCLI
    flags:
      - deploy-git-branching
    steps:
      - IN: deploy-git-branching-deploy-release
      - IN: deploy-git-branching-repo
      - TASK:
        - script: git checkout develop
        - script: git merge --no-ff release

  - name: deploy-git-branching-deploy-hotfix
    type: deploy
    flags:
      - deploy-git-branching
    steps:
      - IN: deploy-git-branching-deploy-release
      - IN: deploy-git-branching-image-hotfix
      - IN: deploy-git-branching-ecs-cluster-hotfix
      - IN: deploy-git-branching-docker-options
      - IN: deploy-git-branching-params
      - IN: deploy-git-branching-replicas
      - TASK: managed
        deployMethod: replace

  - name: deploy-git-branching-deploy-production
    type: deploy
    flags:
      - deploy-git-branching
    steps:
      - IN: deploy-git-branching-deploy-hotfix
      - IN: deploy-git-branching-image-production
      - IN: deploy-git-branching-ecs-cluster-production
      - IN: deploy-git-branching-docker-options
      - IN: deploy-git-branching-params
      - IN: deploy-git-branching-replicas
      - TASK: managed
        deployMethod: replace
